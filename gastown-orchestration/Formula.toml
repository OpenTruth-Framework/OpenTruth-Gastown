[town]
name = "OpenTruth-Verification-Swarm"
description = "A Gastown town dedicated to verifying Rig integrity via OpenTruth (Logic & Vision)."

[infrastructure]
# Point this to where you've cloned the OpenTruth repo
tool_path = "./tools/opentruth"
data_plane = "./data/truth_ledger"

# --- Specialized Agents ---

[[agents]]
name = "Rig-Gauger"
role = "Gauger"
description = "Verifies the LOGIC of a Rig (Unit Tests, Scripts)."
persona = "./gastown-orchestration/agent-prompts.md#gauger"
capabilities = ["run_tests", "read_code"]

[[agents]]
name = "Rig-Spotter"
role = "Spotter"
description = "Verifies the VISUAL state of a Rig (Screenshots, Assets)."
persona = "./gastown-orchestration/agent-prompts.md#spotter"
capabilities = ["computer_vision", "compare_images"]

[[agents]]
name = "Town-Watchdog"
role = "Watchdog"
description = "Audits the security and integrity of the Town."
persona = "./gastown-orchestration/agent-prompts.md#watchdog"

# --- Convoys (Workflows) ---

[[convoys]]
name = "Full-Rig-Verification"
description = "A complete sweep of a Rig's Logic and Visuals."
agents = ["Rig-Gauger", "Rig-Spotter"]

# --- Hooks (The OpenTruth Integration) ---

[hooks]
# Triggered when a Gauger or Spotter commits a finding
# Wraps the raw finding into a Bead for the data plane
on_proof_generated = "python3 ./tools/opentruth/scripts/ot_to_bead.py"

# Pre-commit hook: Run the verifier to ensure no regressions
# This blocks the commit if the Rig is in a broken state
pre_commit_check = "python3 ./tools/opentruth/scripts/verify_rig.py --target ${TARGET_RIG} --role gauger"
